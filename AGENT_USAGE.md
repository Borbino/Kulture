# Agent 사용 가이드 (초안)

목적

- Agent(자동화 도구)를 안전하고 일관되게 운영하기 위한 실무 가이드입니다.
- Ask → Plan → Edit → Review 워크플로우와 권한 부여/회수 방법, 템플릿을 제공합니다.

기본 원칙(요약)

- Agent는 처음에 `Read-Only`로 시작합니다. 변경(Commit) 권한은 단계적으로 부여합니다.
- 모든 변경은 `ReviseLog.md`에 기록해야 합니다. PR/커밋 메시지에 ReviseLog ID를 포함하세요.
- 자동 병합은 `AGENT_POLICY.md`에 정의된 조건(임계값·CI 통과 등)을 만족할 때만 허용됩니다.

권한 단계

1. Read-Only: 저장소 조회만 가능
2. Suggest: PR 생성 가능(자동 커밋 불가)
3. Commit(제한적): 자동 커밋 및 자동 병합(조건 충족 시)
4. Admin: 저장소 설정 변경(CEO 사전 승인 필요)

표준 워크플로우

1. Ask(질의): 담당자 또는 Agent에게 변경 목적·범위·제약을 자연어로 명확히 전달.
2. Plan(계획): 작업을 세부 단계로 분해하고 각 단계의 산출물·검증 기준을 정의.
3. Edit(수정): Agent가 `apply_patch` 형식으로 패치를 생성하고 ReviseLog 항목 초안을 작성.
4. PR 생성: Agent가 PR을 만들고 PR 제목에 ReviseLog ID를 포함.
5. CI/검토: 자동 CI(라인트·테스트·보안스캔) 실행 및 수동 리뷰(임계값 초과 시 필수).
6. 병합/롤백: 조건 만족 시 자동 병합, 실패 시 롤백 및 ReviseLog에 기록.

Agent 지시 템플릿

```
[Agent Command Template]
- 목적: (예: 신규 환경변수 문서화)
- 범위: (예: `docs/config.md` 1파일)
- 출력 형식: Patch (apply_patch 형식) + ReviseLog 항목 초안
- 제한: 변경 파일 수 <= 3, 변경 라인 <= 100
- 추가 요구: PR 생성 후 CEO 자동 병합 허용(조건 충족 시)
```

안전 수칙(체크리스트)

- ReviseLog 항목 초안이 생성되었는가?
- 변경이 secrets/민감 파일을 건드리지 않는가?
- 변경 파일 수와 라인이 정책 임계값을 초과하지 않는가?
- PR 제목/커밋 메시지에 ReviseLog ID가 포함되었는가?
- CI가 모두 통과했는가?

샘플 시나리오

- 문서 개선(낮은 위험): Agent가 `Suggest` 권한으로 PR 생성 → CI 통과 → 자동 병합
- 소규모 버그픽스(중간 위험): Agent가 `Commit` 권한 요청 → ReviseLog 및 CI 통과 → 자동 커밋 가능
- 대규모 리팩터(고위험): Agent는 PR만 생성(수동 리뷰·CEO 승인 필요)

FAQ(간단)

- Q: Agent에게 바로 Commit 권한을 줘도 되나요?
  - A: 권장하지 않습니다. 신뢰를 쌓은 후 단계적으로 권한을 늘리세요.

문서 업데이트 기록

- 작성자: 시스템(초안)
- 생성일: 2025-11-19

(이 문서는 초안입니다. 운영 흐름에 맞춰 수정하겠습니다.)
